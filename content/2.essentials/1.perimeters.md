---
title: Perimeters
description: Structure your applications access scopes.
---

## Perimeter

Create your perimeter using the command:

```bash
php artisan make:perimeter PostPerimeter
```

```php
use Lomkit\Access\Perimeters\Perimeter;

class PostPerimeter extends Perimeter
{
    //
}
```

You don't need to define much more, this is more functional related.

## Overlay Perimeter

In some cases you may want to give the ability for a perimeter to overlay with others. This will make the perimeter 
non-final in use.

```bash
php artisan make:perimeter SharedPerimeter --overlay
```

```php
use Lomkit\Access\Perimeters\OverlayPerimeter;

class SharedPerimeter extends OverlayPerimeter
{
    //
}
```

Here for example we may want a SharedPerimeter to apply first in order to look if the posts has been shared with the current user.   
Surpassing the other perimeters but going in coordination with.

```php
use Illuminate\Database\Eloquent\Builder;

class TaskControl extends Control
{
    protected function perimeters(): array
    {
        return [
            SharedPerimeter::new()
                ->allowed(function (Model $user, string $method) {
                    return true;
                })
                ->should(function (Model $user, Model $model) {
                    return $model->isSharedWith($user);
                })
                ->query(function (Builder $query, Model $user) {
                    return $query->whereHas('task_shared_with_users', function(Builder $query){
                        $query->where('id', $user->id);
                    });
                }),
            GlobalPerimeter::new()
                // ...
        ];
    }
}
```
